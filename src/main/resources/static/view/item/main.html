<meta charset="utf-8" />
<!-- zTree -->
<link rel="stylesheet" href="../../zTree/css/demo.css" type="text/css">
<link rel="stylesheet" href="../../zTree/css/zTreeStyle/zTreeStyle.css" type="text/css">
<script type="text/javascript" src="../../js/jquery-2.1.4.js"></script>
<script type="text/javascript" src="../../zTree/js/jquery.ztree.core-3.5.js"></script>
<script type="text/javascript" src="../../zTree/js/jquery.ztree.excheck-3.5.js"></script>
<script type="text/javascript" src="../../zTree/js/jquery.ztree.exedit-3.5.js"></script>
<script>
	$(function(){
		$("#editBtn").click(function(){
			$('#edit').show();
			$('#saveBtn').show();
			$('#table').hide();
			$('#editBtn').hide();
		});
		$("#saveBtn").click(function(){
			$('#edit').hide();
			$('#saveBtn').hide();
			$('#table').show();
			$('#editBtn').show();

			
			$.ajax({url:"/items",
				type:'POST',
				data: JSON.stringify({description:'描述信息',property:'prop'}),
				contentType: "application/json",
				dataType: 'json',
				success:function(data){
					
				}
			});
			
			
		});
	});
</script>


<table class="table table-bordered table-sm" id="table">
	<thead class="thead-inverse">
		<tr>
			<th>编号</th>
			<th>项目名称</th>
			<th>上级项目</th>
			<th>单价</th>
			<th>定价单位</th>
		</tr>
	</thead>
					<tr>
						<td style="vertical-align: middle;">101</td>
						<td style="vertical-align: middle;">边坡平整</td>
						<td style="vertical-align: middle;"></td>
						<td style="vertical-align: middle;">元</td>
						<td style="vertical-align: middle;">m³</td>
					</tr>
					<tr>
						<td style="vertical-align: middle;">102</td>
						<td style="vertical-align: middle;">地貌恢复（果园、耕地、玉米）</td>
						<td style="vertical-align: middle;">地貌恢复</td>
						<td style="vertical-align: middle;">元</td>
						<td style="vertical-align: middle;">m³</td>
					</tr>
					<tr>
						<td style="vertical-align: middle;">103</td>
						<td style="vertical-align: middle;">地貌恢复（荒地）</td>
						<td style="vertical-align: middle;">地貌恢复</td>
						<td style="vertical-align: middle;">元</td>
						<td style="vertical-align: middle;">m³</td>
					</tr>
					<tr>
						<td style="vertical-align: middle;">104</td>
						<td style="vertical-align: middle;">便道</td>
						<td style="vertical-align: middle;"></td>
						<td style="vertical-align: middle;">元</td>
						<td style="vertical-align: middle;">m³</td>
					</tr>
					<tr>
						<td style="vertical-align: middle;">105</td>
						<td style="vertical-align: middle;">挡墙</td>
						<td style="vertical-align: middle;"></td>
						<td style="vertical-align: middle;">元</td>
						<td style="vertical-align: middle;">m³</td>
					</tr>
<table>
<div id="edit" style="display:none;">
<div class="appli-content-gs-title">
					<!-- 编辑 -->

					<div class="content_wrap">
							<div class="zTreeDemoBackground left" style="margin: 5px">
								<ul id="treeDemo" class="ztree"></ul>
							</div>

							<div class="right">
								<ul class="info">
									<li>&nbsp;&nbsp;&nbsp;&nbsp;[ <a id="addParent" href="#"
										title="增加父节点" onclick="return false;">增加父节点</a> ]
										&nbsp;&nbsp;&nbsp;&nbsp;[ <a id="addLeaf" href="#"
										title="增加叶子节点" onclick="return false;">增加叶子节点</a> ]
										&nbsp;&nbsp;&nbsp;&nbsp;[ <a id="edit" href="#" title="编辑名称"
										onclick="return false;">编辑名称</a> ]<br />
										&nbsp;&nbsp;&nbsp;&nbsp;[ <a id="remove" href="#" title="删除节点"
										onclick="return false;">删除节点</a> ] &nbsp;&nbsp;&nbsp;&nbsp;[ <a
										id="clearChildren" href="#" title="清空子节点"
										onclick="return false;">清空子节点</a> ]<br />
									</li>
								</ul>
								 <tr>
							        <td>名 称:</td>
							        <td><input id="name" type="text" name="name" value=''/></td>
							    </tr>
							    
							    <tr>
							        <td>单 位:</td>
							        <td><input type="text" name="unit" value="元"/></td>
							    </tr>
							    
							    <tr>
							        <td>定价单位:</td>
							        <td><select ><option>m³</option><option>㎡</option><option>m</option><option>个</option><option>根</option><option>吨</option></select></td>
							    </tr>
							</div>

					</div>
</div>
<button id="editBtn" onclick="" class="btn btn-primary">编辑</button>
<button id="saveBtn" onclick="$('#edit').show();$('#table').hide()" class="btn btn-primary" style="display:none;">保存</button>


	<SCRIPT type="text/javascript">
	<!--
		var setting = {
			view : {
				selectedMulti : false
			},
			edit : {
				enable : true,
				showRemoveBtn : false,
				showRenameBtn : false
			},
			data : {
				keep : {
					parent : true,
					leaf : true
				},
				simpleData : {
					enable : true
				}
			},
			callback : {
				beforeDrag : beforeDrag,
				beforeRemove : beforeRemove,
				beforeRename : beforeRename,
				onRemove : onRemove
			},
			callback: {
				onClick: zTreeOnClick
			}
		};

		var zNodes = [ {
			id : 1,
			pId : 0,
			name : "边坡平整",
			open : true,
			isParent : true,
			url : "http://www.baidu.com"
		},

		{
			id : 2,
			pId : 0,
			name : "地貌恢复",
			open : true
		}, {
			id : 21,
			pId : 2,
			name : "地貌恢复（果园、耕地、玉米）"
		}, {
			id : 22,
			pId : 2,
			name : "地貌恢复（荒地）"
		},

		{
			id : 3,
			pId : 0,
			name : "清土方",
			open : true
		}, {
			id : 31,
			pId : 3,
			name : "清土方（人工）"
		}, {
			id : 32,
			pId : 3,
			name : "清土方（机械）"
		},

		];
		var log, className = "dark";
		function beforeDrag(treeId, treeNodes) {
			return false;
		}
		function beforeRemove(treeId, treeNode) {
			className = (className === "dark" ? "" : "dark");
			showLog("[ " + getTime()
					+ " beforeRemove ]&nbsp;&nbsp;&nbsp;&nbsp; "
					+ treeNode.name);
			return confirm("确认删除 节点 -- " + treeNode.name + " 吗？");
		}
		function onRemove(e, treeId, treeNode) {
			showLog("[ " + getTime() + " onRemove ]&nbsp;&nbsp;&nbsp;&nbsp; "
					+ treeNode.name);
		}
		function beforeRename(treeId, treeNode, newName) {
			if (newName.length == 0) {
				alert("节点名称不能为空.");
				var zTree = $.fn.zTree.getZTreeObj("treeDemo");
				setTimeout(function() {
					zTree.editName(treeNode)
				}, 10);
				return false;
			}
			return true;
		}
		function showLog(str) {
			if (!log)
				log = $("#log");
			log.append("<li class='"+className+"'>" + str + "</li>");
			if (log.children("li").length > 8) {
				log.get(0).removeChild(log.children("li")[0]);
			}
		}
		function getTime() {
			var now = new Date(), h = now.getHours(), m = now.getMinutes(), s = now
					.getSeconds(), ms = now.getMilliseconds();
			return (h + ":" + m + ":" + s + " " + ms);
		}

		var newCount = 1;
		function add(e) {
			var zTree = $.fn.zTree.getZTreeObj("treeDemo"), isParent = e.data.isParent, nodes = zTree
					.getSelectedNodes(), treeNode = nodes[0];
			if (treeNode) {
				treeNode = zTree.addNodes(treeNode, {
					id : (100 + newCount),
					pId : treeNode.id,
					isParent : isParent,
					name : "new node" + (newCount++)
				});
			} else {
				treeNode = zTree.addNodes(null, {
					id : (100 + newCount),
					pId : 0,
					isParent : isParent,
					name : "new node" + (newCount++)
				});
			}
			if (treeNode) {
				zTree.editName(treeNode[0]);
			} else {
				alert("叶子节点被锁定，无法增加子节点");
			}
		};
		function edit() {
			var zTree = $.fn.zTree.getZTreeObj("treeDemo"), nodes = zTree
					.getSelectedNodes(), treeNode = nodes[0];
			if (nodes.length == 0) {
				alert("请先选择一个节点");
				return;
			}
			zTree.editName(treeNode);
		};
		function remove(e) {
			var zTree = $.fn.zTree.getZTreeObj("treeDemo"), nodes = zTree
					.getSelectedNodes(), treeNode = nodes[0];
			if (nodes.length == 0) {
				alert("请先选择一个节点");
				return;
			}
			var callbackFlag = $("#callbackTrigger").attr("checked");
			zTree.removeNode(treeNode, callbackFlag);
		};
		function clearChildren(e) {
			var zTree = $.fn.zTree.getZTreeObj("treeDemo"), nodes = zTree
					.getSelectedNodes(), treeNode = nodes[0];
			if (nodes.length == 0 || !nodes[0].isParent) {
				alert("请先选择一个父节点");
				return;
			}
			zTree.removeChildNodes(treeNode);
		};

		$(document).ready(function() {
			$.fn.zTree.init($("#treeDemo"), setting, zNodes);
			$("#addParent").bind("click", {
				isParent : true
			}, add);
			$("#addLeaf").bind("click", {
				isParent : false
			}, add);
			$("#edit").bind("click", edit);
			$("#remove").bind("click", remove);
			$("#clearChildren").bind("click", clearChildren);
		});
	//-->
	</SCRIPT>